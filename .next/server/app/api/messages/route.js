"use strict";(()=>{var e={};e.id=217,e.ids=[217],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},6005:e=>{e.exports=require("node:crypto")},9898:(e,s,t)=>{t.r(s),t.d(s,{headerHooks:()=>p,originalPathname:()=>m,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>d,staticGenerationBailout:()=>T});var r={};t.r(r),t.d(r,{DELETE:()=>DELETE,GET:()=>GET,PATCH:()=>PATCH,POST:()=>POST});var a=t(884),o=t(6132),n=t(5287),i=t(5798),u=t(9189);async function GET(){try{let e=await n.T.get("wall-messages")??[];return i.Z.json(e)}catch(e){return console.error("Failed to fetch messages:",e),i.Z.json({error:"Failed to fetch messages"},{status:500})}}async function POST(e){try{let s=await e.json();console.log("Received message:",s);let t=await n.T.get("wall-messages")??[],r={id:(0,u.Z)(),content:s.content,author:s.author,position:{x:Math.round(s.position.x),y:Math.round(s.position.y)},createdAt:Date.now(),color:s.color||`hsl(${360*Math.random()}, 70%, 80%)`,messageNumber:t.length+1,ownerId:s.ownerId};console.log("Saving new message:",r);let a=[...t,r];return await n.T.set("wall-messages",a),console.log("Messages saved successfully"),i.Z.json(r)}catch(e){return console.error("Failed to save message:",e),i.Z.json({error:"Failed to save message",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}async function PATCH(e){try{let{messageId:s,userId:t,updates:r}=await e.json(),a=await n.T.get("wall-messages")??[],o=a.findIndex(e=>e.id===s);if(-1===o)return i.Z.json({error:"Message not found"},{status:404});if(a[o].ownerId!==t)return i.Z.json({error:"Unauthorized"},{status:403});return a[o]={...a[o],...r},await n.T.set("wall-messages",a),i.Z.json(a[o])}catch(e){return i.Z.json({error:"Failed to update message"},{status:500})}}async function DELETE(e){try{let{messageId:s,userId:t}=await e.json(),r=await n.T.get("wall-messages"),a=r||[],o=a.findIndex(e=>e.id===s);if(-1===o)return i.Z.json({error:"Message not found"},{status:404});if(a[o].ownerId!==t)return i.Z.json({error:"Unauthorized"},{status:403});return a.splice(o,1),await n.T.set("wall-messages",a),i.Z.json({success:!0})}catch(e){return i.Z.json({error:"Failed to delete message"},{status:500})}}let l=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/messages/route",pathname:"/api/messages",filename:"route",bundlePath:"app/api/messages/route"},resolvedPagePath:"C:\\Users\\Raj\\wallofadvice\\src\\app\\api\\messages\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:g,headerHooks:p,staticGenerationBailout:T}=l,m="/api/messages/route"},5287:(e,s,t)=>{t.d(s,{T:()=>a});var r=t(6502);if(!process.env.UPSTASH_REDIS_REST_URL)throw Error("UPSTASH_REDIS_REST_URL is not defined");if(!process.env.UPSTASH_REDIS_REST_TOKEN)throw Error("UPSTASH_REDIS_REST_TOKEN is not defined");let a=new r.s({url:process.env.UPSTASH_REDIS_REST_URL,token:process.env.UPSTASH_REDIS_REST_TOKEN})}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[98,189],()=>__webpack_exec__(9898));module.exports=t})();